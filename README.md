# Тестирование

Для тестирования программы распознавания скачайте данный репозиторий и поместите каталог testImages и скрипт forTestIceRecognition.py в одну папку

flyByPoints2.py это основной скрипт распознавания ледохода в сочетании с автономной навигацией

# Развертывание

Для автономного полёта и распознавания ледохода требуется скопировать скрипты с Гугл диска: "createTrack.py", "flyByPoints.py", "waitMode.py" на компаньон-компьютер дрона.

# Использование

Для автономного полёта требуется сначала указать летный маршрут, делается это благодаря скрипту "createTrack.py". В консоли с активной программой необходимо, пользуясь вспомогательными названиями пунктов на экране, установить координаты маршрута, скорость и высоту полёта по точкам. Чтобы распознавание проходило корректно потребуется указать цветовые диапазоны воды и льда под свои нужды. Далее можно запускать "flyByPoints2.py", программа запросит подтверждение точек и параметров летной миссии, и после этого дрон взлетит. Чтобы воспользоваться режимом ожидания следует в другой консоли запустить скрипт "waitMode.py" или заранее указать место посадки в скрипте "createTrack.py".

# Документация

Описание работы автономного полёта: 

Дрон ориентируется с помощью GPS и датчиков
PixHawk 4, также для улучшения позиционирования дополнительно
используется лазерный дальномер VL53L1X.
Программный код выполняется на компаньон-компьютере Raspberry Pi 4,
соединенном с полетным контроллером PixHawk 4 через USB. На Raspberry
установлен соответствующий образ операционной системы, необходимый для
автономного полета.
С полетным контроллером аналогичная ситуация. Автономный полет
реализован за счет следующих библиотек: ROS Kinetic, OpenCV, Mavros,
Periphery drivers, CLEVER software bundle for autonomous drone control.

Описание работы распознавания:

Фиксация координат ледохода реализована за счёт разбиения летного
маршрута, начиная с первой точки и заканчивая предпоследней, на небольшие
отрезки. Каждые 3 секунды дрон сохраняет в переменную координаты данной
точки пространства, а также делает фотографию и анализ поверхности,
находящейся под ним, на уровень густоты ледяного покрова. После, полученные
данные будут записаны в массив.
Распознавание ледяного покрова, а также воды осуществляется при
помощи библиотеки OpenCV, которая использует заранее заданные цветовые
диапазоны для создания маски изображения. Программа находит контуры и
рассчитывает их внутреннюю площадь в пикселях, после чего находит
соотношение площадей льда и воды, и затем выводится результат в виде уровня
ледохода.
